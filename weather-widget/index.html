<html lang="en" style="" class=" js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths -webkit-"><head>
<meta charset="UTF-8">
<link rel="apple-touch-icon" type="image/png" href="https://static.codepen.io/assets/favicon/apple-touch-icon-5ae1a0698dcc2402e9712f7d01ed509a57814f994c660df9f7a952f3060705ee.png">
<meta name="apple-mobile-web-app-title" content="CodePen">
<link rel="shortcut icon" type="image/x-icon" href="https://static.codepen.io/assets/favicon/favicon-aec34940fbc1a6e787974dcd360f2c6b63348d4b1f4e06c77743096d55480f33.ico">
<link rel="mask-icon" type="" href="https://static.codepen.io/assets/favicon/logo-pin-8f3771b1072e3c38bd662872f6b673a722f4b3ca2421637d5596661b4e2132cc.svg" color="#111">
<title>CodePen - Weather widget</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>
<style>
@import url(https://fonts.googleapis.com/css?family=Montserrat);
@import url(https://fonts.googleapis.com/css?family=Advent+Pro:400,200);
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background-color: #FFFFFF;
  font-family: Montserrat,Arial,sans-serif;
}

.row {
  display: flex;
  justify-content: space-between;
}

h2 {
  font-size: 14px;
}

.widget {
  margin: 0px auto;
  height: 215px;
  position: relative;
  width: 500px;
}

.upper {
  border-radius: 5px 5px 0 0;
  background: #ffffff;
  /*background:#f5f5f5;*/
  height: 210px;
  padding: 20px 20px 0 20px;
}
.upper .date {
  font-size: 12px;
}
.upper .year {
  font-size: 12px;
  color: #c1c1c1;
}
.upper .time {
  font-size: 12px;
  color: #c1c1c1;
}
.upper .place {
  color: #222;
  font-size: 12px;
}
.upper .temp {
  font-size: 40px;
}
.upper .feels-like-temp {
  font-size: 12px;
  color: gray;
}
.upper .icon {
  text-align: right;
}
.upper .des {
  text-align: right;
}
.upper .des::first-letter {
  text-transform: capitalize;
}
.upper .w-info {
  margin-top: 20px;
  margin-bottom: 2px;
  margin-right: 0px;
  margin-left: 0px;
}
.upper .w-info > div {
  display: inline-block;
  float: left;
  width: 25%;
  text-align: center;
}
.upper .w-info img {
  width: 20px;
  padding-right: 2px;
  display: inline-block;
  vertical-align: middle;
}
.upper .w-info span {
  display: inline-block;
  vertical-align: middle;
  line-height: normal;
}

.lower {
  background: #e67354;
  border-radius: 0 0 5px 5px;
  font-family: 'Advent Pro';
  font-weight: 200;
  height: 25px;
  width: 100%;
  padding-left: 20px;
  padding-right: 20px;
}
.lower .w-info {
  margin: 0;
}
.lower .w-info > h2 {
  color: #EEEEEE;
  display: inline-block;
  float: left;
  width: 25%;
  text-align: center;
  line-height: 25px;
  vertical-align: middle;
}

.weather p {
  font-size: 20px;
  padding: 10px 0;
}

.anim {
  animation: fade .8s linear;
}

@keyframes fade {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
</head>
<body translate="no">
<div class="widget update anim">

<div class="upper">
<div class="row">
<div>
<span class="date">May 13</span>
<span class="year">2020</span>
<span class="time">10:16</span>
</div>
<div class="place update">Cornwall, PE</div>
</div>
<div class="row">
<div>
<div class="temp"><span>4.11<sup>o</sup>C</span></div>
<div class="feels-like-temp">Feels like: <span>-1.72<sup>o</sup>C</span></div>
</div>
<div class="icon">
<div>
<img src="http://openweathermap.org/img/wn/04d@2x.png">
</div>
</div>
</div>
<div class="description">
<span>overcast clouds</span>
</div>
<div class="w-info">
<div class="wind">
<img src="https://img.icons8.com/ios/100/000000/wind.png">
<span class="wind-speed">5.7m/s</span>
<img class="wind-dir" src="https://img.icons8.com/ios/100/000000/down.png" style="transform: rotate(270deg);">
</div>
<div class="humidity">

<img src="https://img.icons8.com/ios/100/000000/hygrometer.png">
<span>80%</span>
</div>
<div class="pressure">
<img src="https://img.icons8.com/ios/100/000000/atmospheric-pressure.png">
<span>100.6 kPa</span>
</div>
<div class="uvi">
<img src="https://img.icons8.com/ios/100/000000/sun.png" style="filter: invert(81%) sepia(34%) saturate(6546%) hue-rotate(358deg) brightness(100%) contrast(107%);">
<span style="color: orange;">6.2</span>
</div>
</div>
</div>
<div class="lower">
<div class="w-info">
<h2 class="title">WIND</h2>
<h2 class="title">HUMIDITY</h2>
<h2 class="title">PRESSURE</h2>
<h2 class="title">UV INDEX</h2>
</div>
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.25.3/moment.min.js"></script>
<script id="rendered-js">
const lat = "46.229640"
const lon = "-63.217970"
const units = "metric"
var info = {};
var currentWeather = {}
var cities = [{ name: "Charlottetown", utc: "-3" }]
const city = {
  name: "Cornwall",
  country: "PE"
}
var monthNames = [
  "January",
  "February",
  "March",
  "April",
  "May",
  "June",
  "July",
  "August",
  "September",
  "October",
  "November",
  "December"
];
var current = 0;

function init() {
  var date = new Date();
  document.querySelector('.date').innerHTML = monthNames[date.getMonth()] + " " + date.getDate()
  document.querySelector('.year').innerHTML = date.getFullYear()

  //fetch weather data
  for (var i = 0; i < cities.length; i++) {
    var date = new Date();
    fetch(`https://api.openweathermap.org/data/2.5/onecall?APPID=c458144dcb333ecebc0dca40460acf7b&q=&lat=${lat}&lon=${lon}&units=${units}`)
    .then(response => response.json())
    .then(data => {
      currentWeather = data.current
      update()
    })
    .catch((error) => {
      console.error('Error:', error)
    })
  }
}
init()

//update all information for each place
function update() {
  var today = new Date()
  var time = moment().format('hh:mm')
  var uviColor = "red"
  var uviImgColor = "invert(18%) sepia(98%) saturate(6985%) hue-rotate(1deg) brightness(104%) contrast(117%)"
  if (currentWeather.uvi < 3) {
    uviColor = "green"
    uviImgColor = "invert(21%) sepia(81%) saturate(7356%) hue-rotate(123deg) brightness(98%) contrast(103%)"
  } else if (currentWeather.uvi < 6) {
    uviColor = "gold"
    uviImgColor = "invert(80%) sepia(68%) saturate(1454%) hue-rotate(359deg) brightness(102%) contrast(105%)"
  } else if (currentWeather.uvi < 8) {
    uviColor = "orange"
    uviImgColor = "invert(81%) sepia(34%) saturate(6546%) hue-rotate(358deg) brightness(100%) contrast(107%)"
  }
  
  document.querySelector('.update').classList.add("anim")
  
  document.querySelector('.time').innerHTML = time
  
  document.querySelector('.place').innerHTML = city.name + ", " + city.country
  document.querySelector('.temp span').innerHTML = currentWeather.temp + "<sup>o</sup>C"
  document.querySelector('.feels-like-temp span').innerHTML = currentWeather.feels_like + "<sup>o</sup>C"
  document.querySelector('.description span').innerHTML = currentWeather.weather[0].description
  document.querySelector('.wind-speed').innerHTML = currentWeather.wind_speed + "m/s"
  document.querySelector('.wind-dir').style.transform = "rotate(" + currentWeather.wind_deg + "deg)"

  document.querySelector('.humidity span').innerHTML = currentWeather.humidity + "%"
  document.querySelector('.pressure span').innerHTML = currentWeather.pressure/10 + " kPa"
  document.querySelector('.uvi span').innerHTML = currentWeather.uvi
  document.querySelector('.uvi span').style.color = uviColor
  document.querySelector('.uvi img').style.filter = uviImgColor
  
  document.querySelector('.icon div img').src = getWeatherIconUrl(currentWeather.weather[0].icon)
  
  current = (current + 1) % 18;
  setTimeout(update, 6000);
}

//after fade animation has finished remove the class that caused it so it can be reused
document.querySelect('.update').addEventListener("webkitAnimationEnd oAnimationEnd msAnimationEnd animationend", function(){
  document.querySelector('.update').classList.remove("anim")
})

function getWeatherIconUrl(icon, size="2x") {
  return `http://openweathermap.org/img/wn/${icon}@${size}.png`
}
    </script>


</body></html>